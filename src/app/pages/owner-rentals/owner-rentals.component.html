<div class="container my-5">
  <h1 class="mb-4">Solicitudes Recibidas</h1>
  <p class="lead text-muted">Gestiona las solicitudes de renta para tus propiedades.</p>

  <div *ngIf="isLoading" class="d-flex justify-content-center my-5">
    <div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <div *ngIf="!isLoading && rentals.length > 0">
    <div *ngFor="let rental of rentals" class="card mb-3">
      <div class="card-body">
        <div class="row align-items-center">
          <div class="col-md-6">
            <h5 class="card-title">{{ rental.property.title }}</h5>
            <p class="card-text">
              <strong>Solicitante:</strong> {{ rental.renter?.username }} ({{ rental.renter?.email }})<br>
              <strong>Fecha:</strong> {{ rental.createdAt | date:'medium' }}
            </p>
          </div>
          <div class="col-md-3 text-center">
            <span class="badge fs-6" 
                  [ngClass]="{
                    'bg-warning text-dark': rental.status === 'pending', 
                    'bg-success': rental.status === 'accepted' || rental.status === 'approved', 
                    'bg-danger': rental.status === 'rejected'
                  }">
              {{ rental.status | titlecase }}
            </span>
          </div>
          <div class="col-md-3 text-end" *ngIf="rental.status === 'pending'">
            <button class="btn btn-success me-2" (click)="approveRental(rental.id)">Aprobar</button>
            <button class="btn btn-danger" (click)="rejectRental(rental.id)">Rechazar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && rentals.length === 0" class="text-center text-muted my-5">
    <h4>No has recibido ninguna solicitud de renta</h4>
    <p>Cuando un usuario solicite rentar una de tus propiedades, aparecerá aquí.</p>
  </div>
</div>